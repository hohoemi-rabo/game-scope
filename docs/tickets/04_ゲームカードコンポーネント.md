# 04_ゲームカードコンポーネント

**ステータス**: [完了]
**優先度**: 高
**Phase**: Phase 1 (MVP)

## 概要

トップページとゲーム一覧で使用するゲームカードコンポーネントを実装する。

## 目的

- ゲーム情報を表示するカードコンポーネントの作成
- レスポンシブ対応
- ホバー/クリック時のインタラクション実装
- パフォーマンス最適化（画像の遅延読み込み）

## タスク一覧

### 1. コンポーネント設計
- [x] GameCard コンポーネントの props 設計
- [x] 表示する情報の決定（タイトル、スコア、プラットフォーム、サムネイル）

### 2. GameCard コンポーネント実装
- [x] 基本構造の実装
- [x] スコアバッジの統合
- [x] プラットフォームアイコンの表示
- [x] サムネイル画像の表示

### 3. インタラクション実装
- [x] ホバー時のアニメーション
- [x] クリック時の詳細ページ遷移
- [x] Next.js Link コンポーネントの使用

### 4. 画像最適化
- [x] Next.js Image コンポーネントの使用
- [x] 遅延読み込みの実装
- [x] プレースホルダー画像の設定

### 5. レスポンシブ対応
- [x] モバイル表示の最適化
- [x] タブレット表示の最適化
- [x] デスクトップ表示の最適化

## 実装詳細

### src/app/components/GameCard.tsx

```typescript
import Image from 'next/image'
import Link from 'next/link'
import ScoreBadge from './ScoreBadge'

interface GameCardProps {
  id: string
  titleJa: string | null
  titleEn: string
  metascore: number | null
  platforms: string[]
  thumbnailUrl: string | null
  reviewCount?: number | null
}

/**
 * ゲームカードコンポーネント
 * トップページとゲーム一覧で使用
 */
export default function GameCard({
  id,
  titleJa,
  titleEn,
  metascore,
  platforms,
  thumbnailUrl,
  reviewCount,
}: GameCardProps) {
  // 表示するタイトルを決定（日本語優先）
  const displayTitle = titleJa || titleEn

  return (
    <Link href={`/game/${id}`}>
      <article className="group relative bg-gray-800/50 rounded-lg overflow-hidden
                          border border-gray-700/50 hover:border-accent/50
                          transition-all duration-300 hover:scale-[1.02]
                          hover:shadow-lg hover:shadow-accent/20">
        {/* サムネイル画像 */}
        <div className="relative aspect-video w-full overflow-hidden bg-gray-900">
          {thumbnailUrl ? (
            <Image
              src={thumbnailUrl}
              alt={displayTitle}
              fill
              className="object-cover group-hover:scale-105 transition-transform duration-300"
              sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
              loading="lazy"
            />
          ) : (
            <div className="w-full h-full flex items-center justify-center text-text-secondary">
              <span>No Image</span>
            </div>
          )}

          {/* スコアバッジ（画像の上に重ねて表示） */}
          <div className="absolute top-2 right-2">
            <ScoreBadge score={metascore} size="sm" />
          </div>
        </div>

        {/* ゲーム情報 */}
        <div className="p-4">
          {/* タイトル */}
          <h3 className="text-lg font-bold text-text-primary mb-2 line-clamp-2
                         group-hover:text-accent transition-colors">
            {displayTitle}
          </h3>

          {/* プラットフォームとレビュー数 */}
          <div className="flex items-center justify-between text-sm text-text-secondary">
            {/* プラットフォーム */}
            <div className="flex flex-wrap gap-1">
              {platforms.slice(0, 3).map((platform) => (
                <span
                  key={platform}
                  className="px-2 py-0.5 bg-gray-700/50 rounded text-xs"
                >
                  {platform}
                </span>
              ))}
              {platforms.length > 3 && (
                <span className="px-2 py-0.5 bg-gray-700/50 rounded text-xs">
                  +{platforms.length - 3}
                </span>
              )}
            </div>

            {/* レビュー数 */}
            {reviewCount !== null && reviewCount !== undefined && (
              <span className="text-xs">{reviewCount} reviews</span>
            )}
          </div>
        </div>
      </article>
    </Link>
  )
}
```

### src/app/components/GameGrid.tsx

```typescript
import type { Database } from '@/lib/supabase/types'
import GameCard from './GameCard'

type Game = Database['public']['Tables']['games']['Row']

interface GameGridProps {
  games: Game[]
}

/**
 * ゲーム一覧グリッドコンポーネント
 * GameCard を配置するグリッドレイアウト
 */
export default function GameGrid({ games }: GameGridProps) {
  if (games.length === 0) {
    return (
      <div className="text-center py-12 text-text-secondary">
        <p>ゲームが見つかりませんでした</p>
      </div>
    )
  }

  return (
    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4
                    gap-4 md:gap-6">
      {games.map((game) => (
        <GameCard
          key={game.id}
          id={game.id}
          titleJa={game.title_ja}
          titleEn={game.title_en}
          metascore={game.metascore}
          platforms={game.platforms || []}
          thumbnailUrl={game.thumbnail_url}
          reviewCount={game.review_count}
        />
      ))}
    </div>
  )
}
```

### 使用例（app/page.tsx で使用）

```typescript
import { getTopGames } from '@/lib/supabase/server'
import Container from './components/Container'
import GameGrid from './components/GameGrid'

export default async function HomePage() {
  const games = await getTopGames(20)

  return (
    <Container className="py-8">
      <h1 className="text-4xl font-bold mb-8">高評価ゲーム</h1>
      <GameGrid games={games} />
    </Container>
  )
}
```

## 完了条件

- [x] GameCard コンポーネントが正しくレンダリングされる
- [x] スコアバッジが正しく色分けされる
- [x] プラットフォーム情報が表示される
- [x] サムネイル画像が最適化されて表示される
- [x] ホバー時のアニメーションが動作する
- [x] クリック時にゲーム詳細ページに遷移する
- [x] レスポンシブデザインが機能している

## 関連チケット

- 前: `03_デザインシステム実装.md`
- 次: `05_トップページ実装.md`
- 関連: `06_ゲーム詳細ページ実装.md`

## 参考資料

- [Next.js Image Component](https://nextjs.org/docs/app/api-reference/components/image)
- [Next.js Link Component](https://nextjs.org/docs/app/api-reference/components/link)
- [Tailwind CSS Grid](https://tailwindcss.com/docs/grid-template-columns)
