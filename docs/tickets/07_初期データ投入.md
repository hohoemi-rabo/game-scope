# 07_åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: [å®Œäº†]
**å„ªå…ˆåº¦**: ä¸­
**Phase**: Phase 1 (MVP)

## æ¦‚è¦

Supabase ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åˆæœŸãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆã‚²ãƒ¼ãƒ æƒ…å ±20ä»¶ï¼‰ã‚’æŠ•å…¥ã™ã‚‹ã€‚MVP æ®µéšã§ã®å‹•ä½œç¢ºèªã«ä½¿ç”¨ã€‚

## ç›®çš„

- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æŠ•å…¥
- UI/UX ã®å‹•ä½œç¢ºèª
- OpenCritic API é€£æºã®ãƒ†ã‚¹ãƒˆ

## ã‚¿ã‚¹ã‚¯ä¸€è¦§

### 1. ãƒ‡ãƒ¼ã‚¿åé›†
- [x] OpenCritic ã‹ã‚‰é«˜è©•ä¾¡ã‚²ãƒ¼ãƒ 20ä»¶ã®ãƒªã‚¹ãƒˆã‚’å–å¾—
- [x] ã‚²ãƒ¼ãƒ æƒ…å ±ã®æ•´ç†ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€ã‚¹ã‚³ã‚¢ã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãªã©ï¼‰
- [x] æ—¥æœ¬èªã‚¿ã‚¤ãƒˆãƒ«ã®ãƒãƒƒãƒ”ãƒ³ã‚°

### 2. ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
- [x] `scripts/seed-data.ts` ã®ä½œæˆ
- [x] Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¨­å®š
- [x] ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…

### 3. ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼
- [x] ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãæŠ•å…¥ã•ã‚ŒãŸã‹ç¢ºèª
- [x] Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ç¢ºèª
- [x] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸Šã§ã®è¡¨ç¤ºç¢ºèª

### 4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
- [x] ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®è¨˜éŒ²
- [x] æŠ•å…¥æ‰‹é †ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

## å®Ÿè£…è©³ç´°

### scripts/seed-data.ts

```typescript
import { createClient } from '@supabase/supabase-js'
import type { Database } from '../src/lib/supabase/types'

// Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä½œæˆï¼ˆã‚µãƒ¼ãƒ“ã‚¹ãƒ­ãƒ¼ãƒ«ã‚­ãƒ¼ä½¿ç”¨ï¼‰
const supabase = createClient<Database>(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.SUPABASE_SERVICE_ROLE_KEY!
)

/**
 * åˆæœŸã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
 * OpenCritic ã®é«˜è©•ä¾¡ã‚²ãƒ¼ãƒ ã‹ã‚‰æŠ½å‡º
 */
const seedGames = [
  {
    title_ja: 'ã‚¨ãƒ«ãƒ‡ãƒ³ãƒªãƒ³ã‚°',
    title_en: 'Elden Ring',
    platforms: ['PC', 'PlayStation 5', 'Xbox Series X'],
    metascore: 96,
    review_count: 102,
    release_date: '2022-02-25',
    thumbnail_url: 'https://example.com/elden-ring.jpg',
    opencritic_id: '12345',
  },
  {
    title_ja: 'ã‚¼ãƒ«ãƒ€ã®ä¼èª¬ ãƒ†ã‚£ã‚¢ãƒ¼ã‚º ã‚ªãƒ– ã‚¶ ã‚­ãƒ³ã‚°ãƒ€ãƒ ',
    title_en: 'The Legend of Zelda: Tears of the Kingdom',
    platforms: ['Nintendo Switch'],
    metascore: 96,
    review_count: 145,
    release_date: '2023-05-12',
    thumbnail_url: 'https://example.com/totk.jpg',
    opencritic_id: '12346',
  },
  {
    title_ja: 'ãƒãƒ«ãƒ€ãƒ¼ã‚ºã‚²ãƒ¼ãƒˆ3',
    title_en: 'Baldur\'s Gate 3',
    platforms: ['PC', 'PlayStation 5', 'Xbox Series X'],
    metascore: 96,
    review_count: 89,
    release_date: '2023-08-03',
    thumbnail_url: 'https://example.com/bg3.jpg',
    opencritic_id: '12347',
  },
  // ... æ®‹ã‚Š17ä»¶ã®ãƒ‡ãƒ¼ã‚¿
]

/**
 * ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥
 */
async function seedDatabase() {
  console.log('ğŸŒ± Starting database seeding...')

  try {
    // æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰
    if (process.env.NODE_ENV === 'development') {
      console.log('ğŸ—‘ï¸  Clearing existing data...')
      const { error: deleteError } = await supabase
        .from('games')
        .delete()
        .neq('id', '00000000-0000-0000-0000-000000000000') // å…¨å‰Šé™¤

      if (deleteError) {
        console.warn('Warning: Could not clear existing data:', deleteError)
      }
    }

    // ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥
    console.log(`ğŸ“¥ Inserting ${seedGames.length} games...`)
    const { data, error } = await supabase
      .from('games')
      .insert(seedGames)
      .select()

    if (error) {
      throw error
    }

    console.log(`âœ… Successfully inserted ${data.length} games`)

    // æŠ•å…¥ã•ã‚ŒãŸã‚²ãƒ¼ãƒ ã®ç¢ºèª
    const { data: games, error: fetchError } = await supabase
      .from('games')
      .select('title_ja, title_en, metascore')
      .order('metascore', { ascending: false })
      .limit(5)

    if (fetchError) {
      throw fetchError
    }

    console.log('\nğŸ“Š Top 5 games:')
    games.forEach((game, index) => {
      console.log(`  ${index + 1}. ${game.title_ja || game.title_en} (${game.metascore})`)
    })

    console.log('\nğŸ‰ Database seeding completed!')
  } catch (error) {
    console.error('âŒ Error seeding database:', error)
    process.exit(1)
  }
}

// ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
seedDatabase()
```

### package.json ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 

```json
{
  "scripts": {
    "seed": "tsx scripts/seed-data.ts",
    "seed:prod": "NODE_ENV=production tsx scripts/seed-data.ts"
  }
}
```

### å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install -D tsx
```

### å®Ÿè¡Œæ–¹æ³•

```bash
# é–‹ç™ºç’°å¢ƒã§ã®ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ï¼‰
npm run seed

# æœ¬ç•ªç’°å¢ƒã§ã®ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒï¼‰
npm run seed:prod
```

### ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹

OpenCritic ã‹ã‚‰å–å¾—ã™ã‚‹é«˜è©•ä¾¡ã‚²ãƒ¼ãƒ ã®ä¾‹:

1. **Elden Ring** - 96ç‚¹
2. **The Legend of Zelda: Tears of the Kingdom** - 96ç‚¹
3. **Baldur's Gate 3** - 96ç‚¹
4. **Red Dead Redemption 2** - 95ç‚¹
5. **The Witcher 3: Wild Hunt** - 95ç‚¹
6. **God of War (2018)** - 94ç‚¹
7. **Hades** - 93ç‚¹
8. **Disco Elysium** - 93ç‚¹
9. **Cyberpunk 2077: Phantom Liberty** - 92ç‚¹
10. **Persona 5 Royal** - 92ç‚¹
11. **Stray** - 85ç‚¹
12. **Hollow Knight** - 90ç‚¹
13. **Celeste** - 91ç‚¹
14. **Dead Cells** - 89ç‚¹
15. **Sekiro: Shadows Die Twice** - 91ç‚¹
16. **Ghost of Tsushima** - 88ç‚¹
17. **Spider-Man 2** - 90ç‚¹
18. **Alan Wake 2** - 89ç‚¹
19. **Resident Evil 4 Remake** - 93ç‚¹
20. **Final Fantasy XVI** - 87ç‚¹

### æ—¥æœ¬èªã‚¿ã‚¤ãƒˆãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°

```typescript
const titleMapping: Record<string, string> = {
  'Elden Ring': 'ã‚¨ãƒ«ãƒ‡ãƒ³ãƒªãƒ³ã‚°',
  'The Legend of Zelda: Tears of the Kingdom': 'ã‚¼ãƒ«ãƒ€ã®ä¼èª¬ ãƒ†ã‚£ã‚¢ãƒ¼ã‚º ã‚ªãƒ– ã‚¶ ã‚­ãƒ³ã‚°ãƒ€ãƒ ',
  'Baldur\'s Gate 3': 'ãƒãƒ«ãƒ€ãƒ¼ã‚ºã‚²ãƒ¼ãƒˆ3',
  'Red Dead Redemption 2': 'ãƒ¬ãƒƒãƒ‰ãƒ»ãƒ‡ãƒƒãƒ‰ãƒ»ãƒªãƒ‡ãƒ³ãƒ—ã‚·ãƒ§ãƒ³2',
  'The Witcher 3: Wild Hunt': 'ã‚¦ã‚£ãƒƒãƒãƒ£ãƒ¼3 ãƒ¯ã‚¤ãƒ«ãƒ‰ãƒãƒ³ãƒˆ',
  // ... ãã®ä»–ã®ãƒãƒƒãƒ”ãƒ³ã‚°
}
```

## å®Œäº†æ¡ä»¶

- [x] ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [x] 20ä»¶ã®ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãæŠ•å…¥ã•ã‚Œã¦ã„ã‚‹
- [x] ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã§ã‚²ãƒ¼ãƒ ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚²ãƒ¼ãƒ è©³ç´°ãƒšãƒ¼ã‚¸ã§å„ã‚²ãƒ¼ãƒ ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ (ãƒã‚±ãƒƒãƒˆ06ã§å®Ÿè£…äºˆå®š)
- [x] ã‚¹ã‚³ã‚¢ã®è‰²åˆ†ã‘ãŒæ­£ã—ãæ©Ÿèƒ½ã—ã¦ã„ã‚‹

## é–¢é€£ãƒã‚±ãƒƒãƒˆ

- å‰: `06_ã‚²ãƒ¼ãƒ è©³ç´°ãƒšãƒ¼ã‚¸å®Ÿè£….md`
- æ¬¡: `08_æ¤œç´¢æ©Ÿèƒ½å®Ÿè£….md` (Phase 2)

## å‚è€ƒè³‡æ–™

- [OpenCritic](https://opencritic.com/)
- [Supabase Database](https://supabase.com/docs/guides/database)

## æ³¨æ„äº‹é …

- OpenCritic API ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€API ã‚­ãƒ¼ã®å–å¾—ã¨åˆ©ç”¨è¦ç´„ã®ç¢ºèªãŒå¿…è¦
- ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®URLã¯å®Ÿéš›ã®ç”»åƒURLã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚‹
- æœ¬ç•ªç’°å¢ƒã§ã¯æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ãªã„ã‚ˆã†æ³¨æ„
